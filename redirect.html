<script>
  (function () {
    const qs = window.location.search || '';
    const hash = window.location.hash || '';
    const deepLink = 'ezidiid://reset-password' + qs + hash;

    const debugEl = document.getElementById('debug');
    const btn = document.getElementById('openBtn');
    const status = document.getElementById('status');

    btn.href = deepLink;

    debugEl.textContent =
      'URL: ' + window.location.href + '\nDeepLink: ' + deepLink;

    // Wichtig: NICHT automatisch weiterleiten!
    status.textContent = 'Status: Tippe auf „App öffnen“.';

    btn.addEventListener('click', function (e) {
      e.preventDefault();
      status.textContent = 'Status: versuche App zu öffnen…';
      // bewusst via user gesture
      window.location.href = deepLink;

      // Falls iOS nicht öffnet
      setTimeout(() => {
        status.textContent =
          'Status: Wenn nichts passiert, tippe nochmal. iOS blockt das manchmal.';
      }, 1200);
    });
  })();
</script>
